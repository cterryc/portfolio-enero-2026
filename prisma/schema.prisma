// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Project {
  id              String   @id
  title           String
  description     String
  longDescription String   @map("long_description")
  liveUrl         String   @map("live_url")
  repoUrl         String   @map("repo_url")
  imageUrl        String   @map("image_url")
  technologies    Json // Array de strings  
  features        Json // Array de strings  
  codeSnippet     Json     @map("code_snippet") // {file, language, lines[]}  
  createdAt       DateTime @default(now()) @map("created_at")

  stats ProjectStat[]

  @@map("projects")
}

model ProjectStat {
  id        Int    @id @default(autoincrement())
  projectId String @map("project_id")
  label     String
  val       String
  color     String

  project Project @relation(fields: [projectId], references: [id], onDelete: Cascade)

  // Esto crea una regla: No puede haber dos registros con mismo label Y mismo projectId
  @@unique([projectId, label])
  @@map("project_stats")
}

model Commit {
  id        Int      @id @default(autoincrement())
  hash      String   @unique
  role      String
  company   String
  date      String
  head      Boolean  @default(false)
  branch    String
  merge     Boolean  @default(false)
  details   Json // {title, description, achievements[], technologies[], period, location}  
  createdAt DateTime @default(now()) @map("created_at")

  @@map("commits")
}

model Skill {
  id       Int    @id @default(autoincrement())
  category String // 'frontend' o 'backend'  
  label    String
  status   String
  val      String
  color    String

  @@map("skills")
}
